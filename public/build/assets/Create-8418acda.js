import{q as x,W as J,r as d,j as l,a,d as K,b as M,f as u}from"./app-5d3c54c0.js";import{P as v}from"./PrimaryButton-4ba8ed79.js";import{A as R}from"./AuthenticatedLayout-a8779a2a.js";import{D as N}from"./DangerButton-ca36b883.js";import{S as T}from"./SecondaryButton-f2982bdc.js";import{d as U}from"./debounce-5ba1e8ab.js";import X from"./Pagination-657cd4ba.js";import"./AdminAuthenticatedHeader-34f587c9.js";import"./ApplicationLogo-4f696bd7.js";import"./transition-3792009f.js";import"./AuthenticatedLibraryHeader-11d4597b.js";function ne({auth:b,books:h,addedBooks:o}){const _=x().props.filters,g=x().props.currentPage,{data:m,setData:w,get:S}=J({search:_.search}),[c,n]=d.useState([]),[p,C]=d.useState(""),[y,q]=d.useState(""),[j,B]=d.useState(""),[P,D]=d.useState(null);d.useEffect(()=>{o.length>0&&n(o)},[o]);const A=r=>{w("search",r.target.value)},E=()=>{S(route("book.create",{search:m.search,page:g}),{preserveScroll:!0,preserveState:!0,replace:!0})},f=d.useCallback(U(E,500),[m.search,g]);d.useEffect(()=>(f(),f.cancel),[m.search,f]);const V=(r,s)=>{r.preventDefault();const{book_id:t,qty:i,price:e,ad_image:z,offer:G}=c.filter(H=>H.book_id===s)[0];u.post(route("book.update",s),{book_id:t,qty:i,price:e,offer:G,ad_image:z},{preserveScroll:!0})},L=r=>{if(y===""||p===""){alert("الرجاء اضافه اكمال جميع بيانات الكتاب");return}u.post(route("book.store"),{book_id:r,qty:p,price:y,offer:j,ad_image:P},{preserveScroll:!0})},k=(r,s)=>{r.preventDefault(),u.delete(route("book.destroy",s),{preserveScroll:!0,onSuccess:()=>{n(t=>t.filter(i=>i.book_id!==s))}})},F=(r,s)=>{r.preventDefault(),u.post(route("book.restore",s),{preserveScroll:!0,onSuccess:()=>{n(t=>t.filter(i=>i.book_id!==s))}})},I=(r,s)=>{const{value:t}=r.target;C(t),t!==""&&n(i=>i.map(e=>e.book_id===s?{...e,qty:t}:e))},O=(r,s)=>{const{value:t}=r.target;q(t),t!==""&&n(i=>i.map(e=>e.book_id===s?{...e,price:t}:e))},Q=(r,s)=>{const{value:t}=r.target;B(t),t!==""&&n(i=>i.map(e=>e.book_id===s?{...e,offer:t}:e))},W=(r,s)=>{D(r.target.files[0]),r.target.files[0]&&n(t=>t.map(i=>i.book_id===s?{...i,ad_image:r.target.files[0]}:i))};return l(R,{user:b.user,header:l("div",{className:"flex items-center justify-between",children:[a("h2",{className:"flex flex-col gap-2 font-semibold text-xl text-gray-800 leading-tight",children:a("span",{children:"إضافة كتاب جديد"})}),a(K,{href:route("library.dashboard"),children:a(v,{children:"العودة"})})]}),children:[a(M,{title:"إضافة كتاب جديد"}),a("div",{className:"py-4",children:l("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[a("div",{className:" max-w-full  px-6 ",children:a("div",{className:"flex-1",children:a("input",{className:" w-full p-3 border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",type:"text",id:"search",name:"search",value:m.search||"",onChange:A,autoFocus:!0,placeholder:"ابحث بإسم الكتاب او الكاتب ..."})})}),a("div",{className:" overflow-hidden sm:rounded-lg",children:l("div",{className:"p-6 text-gray-900",children:[a("div",{className:"grid grid-cols-1 sm:grid-cols-2  gap-3",children:h.data.map(r=>{var s,t,i;return a("div",{className:"max-w-lg bg-white border border-gray-200 rounded-lg shadow h-full",children:l("div",{className:"flex flex-col p-5 h-full",children:[a("h5",{className:"mb-1 text-xl font-semibold text-gray-900",children:r.book_name}),a("div",{className:"py-2 flex-1",children:l("ul",{className:"flex itmes-center   gap-2 mb-2",children:[l("li",{className:"mb-2 text-gray-700",children:[a("strong",{className:"text-gray-700",children:"الكاتب:"})," ",r.author_name]}),l("li",{className:"mb-2 text-gray-700",children:[a("strong",{className:"text-gray-700",children:"رقم الطبعة:"})," ",r.edition_number]}),l("li",{className:"text-gray-700",children:[a("strong",{className:"text-gray-700",children:"رقم المجلد:"})," ",r.volume_number]})]})}),l("div",{className:"flex items-center justify-center flex-wrap gap-2",children:[a("input",{onChange:e=>I(e,r.id),type:"number",className:"w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",min:1,defaultValue:((s=c.find(e=>e.book_id===r.id))==null?void 0:s.qty)||"",placeholder:"الكمية"}),a("input",{onChange:e=>O(e,r.id),type:"number",className:"w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",min:1,defaultValue:((t=c.find(e=>e.book_id===r.id))==null?void 0:t.price)||"",placeholder:"السعر"}),a("input",{onChange:e=>Q(e,r.id),type:"text",className:"w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",min:1,defaultValue:((i=c.find(e=>e.book_id===r.id))==null?void 0:i.offer)||"",placeholder:"عرض إضافي"}),a("div",{className:"py-4 w-full",children:l("label",{className:"flex items-center justify-center w-full py-2 px-4 border border-gray-300 rounded-md shadow-sm transition duration-300 focus:border-indigo-500 focus:ring-indigo-500 hover:border-indigo-500 focus:outline-none hover:cursor-pointer",children:[a("span",{className:"mr-2",children:"أختر صورة الأعلان"}),a("input",{name:"adImage",onChange:e=>W(e,r.id),type:"file",className:"hidden"})]})})]}),l("div",{className:"flex pt-2",children:[l("div",{className:"flex-1",children:[!o.some(e=>e.book_id==r.id)&&a(v,{onClick:()=>L(r.id),children:"أضف"}),o.some(e=>e.book_id==r.id)&&a(T,{onClick:e=>V(e,r.id),children:"تحديث"})]}),c.some(e=>e.book_id===r.id)&&a("div",{children:c.some(e=>e.book_id===r.id&&e.deleted_at===null)?a(N,{onClick:e=>k(e,r.id),children:"حذف"}):a(N,{onClick:e=>F(e,r.id),children:"إستعادة"})})]})]})},r.id)})}),a(X,{links:h.links})]})})]})})]})}export{ne as default};
