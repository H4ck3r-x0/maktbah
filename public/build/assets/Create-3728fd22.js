import{q as w,W as J,r as c,j as l,a as t,d as K,b as M,g as u}from"./app-5b191ced.js";import{P as h}from"./PrimaryButton-103a4157.js";import{A as R}from"./AuthenticatedLayout-4892410d.js";import{D as C}from"./DangerButton-123ba14e.js";import{S as T}from"./SecondaryButton-3e8c5108.js";import{d as U}from"./debounce-84ea11fa.js";import X from"./Pagination-aacc582a.js";import"./AdminAuthenticatedHeader-5b72b578.js";import"./ApplicationLogo-ea6be9c5.js";import"./transition-df8e3c3e.js";import"./AuthenticatedLibraryHeader-96733d59.js";function ce({auth:S,books:g,addedBooks:o}){const q=w().props.filters,p=w().props.currentPage,{data:m,setData:j,get:B}=J({search:q.search}),[d,n]=c.useState([]),[x,y]=c.useState(""),[v,N]=c.useState(""),[P,b]=c.useState(""),[A,_]=c.useState(null);c.useEffect(()=>{o.length>0&&n(o)},[o]);const D=e=>{j("search",e.target.value)},E=()=>{B(route("book.create",{search:m.search,page:p}),{preserveScroll:!0,preserveState:!0,replace:!0})},f=c.useCallback(U(E,500),[m.search,p]);c.useEffect(()=>(f(),f.cancel),[m.search,f]);const V=e=>{e.preventDefault(),u.post(route("book.store"),{libBooks:d})},k=(e,i)=>{e.preventDefault();const{book_id:a,qty:s,price:r,ad_image:H,offer:Y}=d.filter(I=>I.book_id===i)[0];u.post(route("book.update",i),{book_id:a,qty:s,price:r,ad_image:H},{preserveScroll:!0})},L=e=>{if(v===""||x===""){alert("الرجاء اضافه اكمال جميع بيانات الكتاب");return}const i=o.find(s=>s.book_id===e),a=i?i.deleted_at:null;n(s=>[...s,{book_id:e,qty:x,price:v,offer:P,ad_image:A,deleted_at:a}]),y(""),N(""),b(""),_(null)},O=(e,i)=>{e.preventDefault(),u.delete(route("book.destroy",i),{preserveScroll:!0,onSuccess:()=>{n(a=>a.filter(s=>s.book_id!==i))}})},Q=(e,i)=>{e.preventDefault(),u.post(route("book.restore",i),{preserveScroll:!0,onSuccess:()=>{n(a=>a.filter(s=>s.book_id!==i))}})},W=(e,i)=>{const{value:a}=e.target;y(a),a!==""&&n(s=>s.map(r=>r.book_id===i?{...r,qty:a}:r))},z=(e,i)=>{const{value:a}=e.target;N(a),a!==""&&n(s=>s.map(r=>r.book_id===i?{...r,price:a}:r))},F=(e,i)=>{const{value:a}=e.target;b(a),a!==""&&n(s=>s.map(r=>r.book_id===i?{...r,offer:a}:r))},G=(e,i)=>{_(e.target.files[0]),e.target.files[0]&&n(a=>a.map(s=>s.book_id===i?{...s,ad_image:e.target.files[0]}:s))};return console.log(d),l(R,{user:S.user,header:l("div",{className:"flex items-center justify-between",children:[t("h2",{className:"flex flex-col gap-2 font-semibold text-xl text-gray-800 leading-tight",children:t("span",{children:"إضافة كتاب جديد"})}),t(K,{href:route("library.dashboard"),children:t(h,{children:"العودة"})})]}),children:[t(M,{title:"إضافة كتاب جديد"}),t("div",{className:"py-4",children:l("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:[l("div",{className:" max-w-2xl  px-6 flex items-center gap-3",children:[t("div",{className:"flex-1",children:t("input",{className:" w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",type:"text",id:"search",name:"search",value:m.search||"",autoComplete:"search",onChange:D,placeholder:"ابحث بإسم الكتاب او الكاتب ..."})}),t("form",{onSubmit:V,children:t(h,{children:"إضافة الكتب"})})]}),t("div",{className:" overflow-hidden sm:rounded-lg",children:l("div",{className:"p-6 text-gray-900",children:[t("div",{className:"grid grid-cols-1 sm:grid-cols-2  gap-3",children:g.data.map(e=>{var i,a,s;return t("div",{className:"max-w-lg bg-white border border-gray-200 rounded-lg shadow h-full",children:l("div",{className:"flex flex-col p-5 h-full",children:[t("h5",{className:"mb-1 text-xl font-semibold text-gray-900",children:e.book_name}),t("div",{className:"py-2 flex-1",children:l("ul",{className:"flex itmes-center   gap-2 mb-2",children:[l("li",{className:"mb-2 text-gray-700",children:[t("strong",{className:"text-gray-700",children:"الكاتب:"})," ",e.author_name]}),l("li",{className:"mb-2 text-gray-700",children:[t("strong",{className:"text-gray-700",children:"رقم الطبعة:"})," ",e.edition_number]}),l("li",{className:"text-gray-700",children:[t("strong",{className:"text-gray-700",children:"رقم المجلد:"})," ",e.volume_number]})]})}),l("div",{className:"flex items-center justify-center flex-wrap gap-2",children:[t("input",{onChange:r=>W(r,e.id),type:"number",className:"w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",min:1,defaultValue:((i=d.find(r=>r.book_id===e.id))==null?void 0:i.qty)||"",placeholder:"الكمية"}),t("input",{onChange:r=>z(r,e.id),type:"number",className:"w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",min:1,defaultValue:((a=d.find(r=>r.book_id===e.id))==null?void 0:a.price)||"",placeholder:"السعر"}),t("input",{onChange:r=>F(r,e.id),type:"text",className:"w-full border-gray-300 focus:border-indigo-500 focus:ring-indigo-500 rounded-md shadow-sm",min:1,defaultValue:((s=d.find(r=>r.book_id===e.id))==null?void 0:s.offer)||"",placeholder:"عرض إضافي"}),t("div",{className:"py-4 w-full",children:l("label",{className:"flex items-center justify-center w-full py-2 px-4 border border-gray-300 rounded-md shadow-sm transition duration-300 focus:border-indigo-500 focus:ring-indigo-500 hover:border-indigo-500 focus:outline-none hover:cursor-pointer",children:[t("span",{className:"mr-2",children:"أختر صورة الأعلان"}),t("input",{name:"adImage",onChange:r=>G(r,e.id),type:"file",className:"hidden"})]})})]}),l("div",{className:"flex pt-2",children:[l("div",{className:"flex-1",children:[!o.some(r=>r.book_id==e.id)&&t(h,{onClick:()=>L(e.id),children:"أضف"}),o.some(r=>r.book_id==e.id)&&t(T,{onClick:r=>k(r,e.id),children:"تحديث"})]}),d.some(r=>r.book_id===e.id)&&t("div",{children:d.some(r=>r.book_id===e.id&&r.deleted_at===null)?t(C,{onClick:r=>O(r,e.id),children:"حذف"}):t(C,{onClick:r=>Q(r,e.id),children:"إستعادة"})})]})]})},e.id)})}),t(X,{links:g.links})]})})]})})]})}export{ce as default};
